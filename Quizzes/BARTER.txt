              Обласна олімпіада з інформатики -1994 р.,2 тур.
                         БАРТЕР (100 балів)
     В умовах інфляції багато підприємців  віддають  перевагу  обміну
своєї продукції  на  необхідні  товари  (бартеру),  а не продажу про-
дукції.  Припустимо, що кожне підприємство може обміняти деяку  кіль-
кість своєї продукції та визначає її ціну.  Для кожного  підприємства
визначено множину підприємств, в продукції  яких  воно  зацікавлене.
Підприємство може  передати  іншим  будь-яку кількість свого товару в
межах наявного, але не може пропонувати чужу продукцію.
     Біржа може  виступати посередником в бартері між виробниками то-
варів, організуючи не тільки попарні обміни,  а й  більш  складні,  з
дотриманням єдиної умови: кожен клієнт повинен отримати необхідні йо-
му товари з такою ж сумарною вартістю,  на яку  він  надав  продукції
іншим, наприклад:  підприємство  А  надає підприємству В товару на 90
млн,  В надає С та D товару відповідно на 70 та 20 млн, а С та D  на-
дають підприємству А товари на такі ж суми.
     ЗАВДАННЯ: Написати програму,  що для заданих пропозицій  та  за-
питів товарів запропонує таку комбінацію бартерних угод,  щоб сумарна
вартість обміняних була якомога більшою.
                           ТЕХНІЧНІ УМОВИ.
     1. Імена файлів програми,  вхідних та вихідних даних - BARTER.
     2. В  кожному тесті спочатку перераховано пропозиції товарів,  а
потім, після рядка з символом '-' - запити товарів.  Кожен рядок про-
позиції містить  2 натуральних числа:  номер підприємства та загальну
вартість продукції,  запропонованої ним до обміну. Кожен рядок запиту
містить 2 натуральних числа:  номер підприємства,  що запитує товар,
та номер підприємства-виробника товару.  Пропозиції впорядковано  за
зростанням першого  числа.  Запити впорядковано за зростанням першого
числа, а при однакових перших - за зростанням другого.
     3. Результат для кожного тесту - список угод,  кожен рядок якого
містить 3 чісла:  номер підприємства-виробника,  номер  підприємства,
що отримує  товар,  та  загальну вартість товару.  Далі треба вивести
список результатів бартеру для всіх  учасників  обміну,  кожен  рядок
якого містить 3 числа:  номер підприємства та загальні вартості нада-
них та  отриманих ним товарів.  Списки впорядковуйте таким же  чином,
як у вхідних даних.  В кінці треба вивести  загальну  вартість  всіх
обміняних товарів.
     4. Номери підпиємств не перевищують 15, грошові суми - 30000.
                      Підготував В.О. Бардадим.
